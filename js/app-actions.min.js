var $jscomp={scope:{},findInternal:function(b,d,h){b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var m=b[f];if(d.call(h,m,f,b))return{i:f,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,h){if(h.get||h.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[d]=h.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,d,h,e){if(d){h=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var f=b[e];f in h||(h[f]={});h=h[f]}b=b[b.length-1];e=h[b];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(h,b,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,h){return $jscomp.findInternal(this,b,h).v}},"es6-impl","es3");
sysPass.Actions=function(b){var d=b.log,h,e={doAction:"/ajax/ajax_getContent.php",updateItems:"/ajax/ajax_getItems.php",user:{savePreferences:"/ajax/ajax_userPrefsSave.php",password:"/ajax/ajax_usrpass.php",passreset:"/ajax/ajax_passReset.php"},main:{login:"/ajax/ajax_doLogin.php",install:"/ajax/ajax_install.php",twofa:"/ajax/ajax_2fa.php",getUpdates:"/ajax/ajax_checkUpds.php"},checks:"/ajax/ajax_checkConnection.php",config:{save:"/ajax/ajax_configSave.php","export":"/ajax/ajax_export.php","import":"/ajax/ajax_import.php"},
file:"/ajax/ajax_filesMgmt.php",link:"/ajax/ajax_itemSave.php",account:{save:"/ajax/ajax_itemSave.php",showPass:"/ajax/ajax_accViewPass.php",saveFavorite:"/ajax/ajax_appMgmtSave.php",request:"/ajax/ajax_sendRequest.php",getFiles:"/ajax/ajax_accGetFiles.php",search:"/ajax/ajax_accSearch.php"},appMgmt:{show:"/ajax/ajax_itemShow.php",save:"/ajax/ajax_itemSave.php",search:"/ajax/ajax_itemSearch.php"},eventlog:"/ajax/ajax_eventlog.php",wiki:{show:"/ajax/ajax_wiki.php"}},f=function(a){a={actionId:a.actionId,
itemId:"undefined"!==typeof a.itemId?a.itemId:0,isAjax:1};var c=b.appRequests().getRequestOpts();c.url=e.doAction;c.type="html";c.addHistory=!0;c.data=a;b.appRequests().getActionCall(c,function(b){$("#content").empty().html(b)})},m=function(a){d.info("updateItems");var c=$("#"+a.data("item-dst"))[0].selectize;c.clearOptions();c.load(function(c){var g=b.appRequests().getRequestOpts();g.url=e.updateItems;g.method="get";g.data={sk:b.sk.get(),itemType:a.data("item-type")};b.appRequests().getActionCall(g,
function(b){c(b.items)})})},q=function(a,c){$.magnificPopup.open({items:{src:c,type:"inline"},callbacks:{open:function(){b.appTriggers().views.common("#fancyContainer")},close:function(){a.data("item-dst")&&m(a)}},showCloseBtn:!1})},r=function(a,c){var g=$('<div id="fancyContainer" class="image">'+c+"</div>"),d=g.find("img");d.hide();$.magnificPopup.open({items:{src:g,type:"inline"},callbacks:{open:function(){var a=this;d.on("click",function(){a.close()});setTimeout(function(){b.resizeImage(d);g.css("background-color",
"#fff")},500)}}})},p={logout:function(){var a=window.location.search;b.redirect(0<a.length?"index.php"+a+"&logout=1":"index.php?logout=1")},login:function(a){d.info("main:login");var c=b.appRequests().getRequestOpts();c.url=e.main.login;c.data=a.serialize();b.appRequests().getActionCall(c,function(c){switch(c.status){case 0:b.redirect(c.data.url);break;case 2:b.msg.out(c);a.find("input[type='text'],input[type='password']").val("");a.find("input:first").focus();$("#mpass").prop("disabled",!1).val("");
$("#smpass").show();break;default:b.msg.out(c),a.find("input[type='text'],input[type='password']").val(""),a.find("input:first").focus()}})},install:function(a){d.info("main:install");var c=b.appRequests().getRequestOpts();c.url=e.main.install;c.data=a.serialize();b.appRequests().getActionCall(c,function(a){b.msg.out(a);0==a.status&&setTimeout(function(){b.redirect("index.php")},1E3)})},twofa:function(a){d.info("main:twofa");var c=b.appRequests().getRequestOpts();c.url=e.main.twofa;c.data=a.serialize();
b.appRequests().getActionCall(c,function(a){b.msg.out(a);0==a.status&&setTimeout(function(){b.redirect("index.php")},1E3)})},getUpdates:function(a){d.info("main:getUpdates");a=b.appRequests().getRequestOpts();a.url=e.main.getUpdates;a.type="html";a.method="get";a.timeout=1E4;a.useLoading=!1;a.data={isAjax:1};b.appRequests().getActionCall(a,function(b){$("#updates").html(b);"undefined"!==typeof componentHandler&&componentHandler.upgradeDom()},function(){$("#updates").html("!")})}},l={show:function(b){d.info("account:show");
f({actionId:b.data("action-id"),itemId:b.data("item-id")})},showHistory:function(b){d.info("account:showHistory");f({actionId:b.data("action-id"),itemId:b.val()})},edit:function(b){d.info("account:edit");f({actionId:b.data("action-id"),itemId:b.data("item-id")})},"delete":function(a){d.info("account:delete");var c='<div id="alert"><p id="alert-text">'+b.config().LANG[3]+"</p></div>";showDialog({text:c,negative:{title:b.config().LANG[44],onClick:function(a){a.preventDefault();b.msg.error(b.config().LANG[44])}},
positive:{title:b.config().LANG[43],onClick:function(c){c=b.appRequests().getRequestOpts();c.url=e.account.save;c.data={itemId:a.data("item-id"),actionId:a.data("action-id"),sk:b.sk.get()};b.appRequests().getActionCall(c,function(a){b.msg.out(a);l.search()})}}})},showpass:function(a){d.info("account:showpass");var c=b.appRequests().getRequestOpts();c.url=e.account.showPass;c.data={itemId:a.data("item-id"),isHistory:a.data("history"),isFull:a.data("full"),isAjax:1};b.appRequests().getActionCall(c,
function(a){if(10===a.status)p.logout();else{var c;$("<div></div>").dialog({modal:!0,title:b.config().LANG[47],width:"auto",open:function(){c=$(this);var g,d="";g='<button class="dialog-clip-user-button ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" data-clipboard-target=".dialog-user-text"><span class="ui-button-icon-primary ui-icon ui-icon-clipboard"></span><span class="ui-button-text">'+b.config().LANG[33]+"</span></button>";var e='<button class="dialog-clip-pass-button ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" data-clipboard-target=".dialog-pass-text"><span class="ui-button-icon-primary ui-icon ui-icon-clipboard"></span><span class="ui-button-text">'+
b.config().LANG[34]+"</span></button>",d=a.useimage,k='<p class="dialog-user-text">'+a.acclogin+"</p>";0===a.status?(0===d?d='<p class="dialog-pass-text">'+a.accpass+"</p>":(d='<img class="dialog-pass-text" src="data:image/png;base64,'+a.accpass+'" />',e=""),g=k+d+'<div class="dialog-buttons">'+g+e+"</div>"):(g='<span class="altTxtRed">'+a.description+"</span>",c.dialog("option","buttons",[{text:"Ok",icons:{primary:"ui-icon-close"},click:function(){c.dialog("close")}}]));c.html(g);c.dialog("option",
"position","center");c.parent().on("mouseleave",function(){clearTimeout(h);h=setTimeout(function(){c.dialog("close")},3E4)})},close:function(){clearTimeout(h);c.dialog("destroy")}})}})},copypass:function(a){d.info("account:copypass");var c=b.appRequests().getRequestOpts();c.url=e.account.showPass;c.async=!1;c.data={itemId:a.data("item-id"),isHistory:a.data("history"),isAjax:1};return b.appRequests().getActionCall(c)},copy:function(b){d.info("account:copy");f({actionId:b.data("action-id"),itemId:b.data("item-id")})},
savefavorite:function(a,c){d.info("account:saveFavorite");var g="on"===a.data("status"),k={actionId:g?a.data("action-id-off"):a.data("action-id-on"),itemId:a.data("item-id"),sk:b.sk.get(),isAjax:1},f=b.appRequests().getRequestOpts();f.url=e.account.saveFavorite;f.data=k;b.appRequests().getActionCall(f,function(d){b.msg.out(d);0===d.status&&(a.data("status",g?"off":"on"),"function"===typeof c&&c())})},request:function(a){d.info("account:request");var c=b.appRequests().getRequestOpts();c.url=e.account.request;
c.data=a.serialize();b.appRequests().getActionCall(c,function(a){b.msg.out(a)})},menu:function(b){b.hide();b.parent().children(".actions-optional").show(250)},sort:function(b){d.info("account:sort");var a=$("#frmSearch");a.find('input[name="skey"]').val(b.data("key"));a.find('input[name="sorder"]').val(b.data("dir"));a.find('input[name="start"]').val(b.data("start"));l.search()},editpass:function(b){d.info("account:editpass");f({actionId:b.data("action-id"),itemId:b.data("item-id")})},restore:function(b){d.info("account:restore");
l.save(b)},getfiles:function(a){d.info("account:getfiles");var c=b.appRequests().getRequestOpts();c.method="get";c.type="html";c.url=e.account.getFiles;c.data={id:a.data("item-id"),del:a.data("delete"),sk:b.sk.get()};b.appRequests().getActionCall(c,function(b){a.html(b)})},search:function(){d.info("account:search");var a=$("#frmSearch");a.find("input[name='sk']").val(b.sk.get());a.find("input[name='skey']").val();a.find("input[name='sorder']").val();var c=b.appRequests().getRequestOpts();c.url=e.account.search;
c.data=a.serialize();b.appRequests().getActionCall(c,function(c){10===c.status&&b.msg.out(c);b.sk.set(c.sk);$("#res-content").empty().html(c.html);a.find("input:first").focus()})},save:function(a){d.info("account:save");var c=b.appRequests().getRequestOpts();c.url=e.account.save;c.data=a.serialize();b.appRequests().getActionCall(c,function(a){b.msg.out(a)})}},n={refreshTab:!0,show:function(a){d.info("appMgmt:show");if(a.data("item-dst")||!a.data("activetab"))n.refreshTab=!1;var c=b.appRequests().getRequestOpts();
c.url=e.appMgmt.show;c.data={itemId:a.data("item-id"),actionId:a.data("action-id"),activeTab:a.data("activetab"),sk:b.sk.get(),isAjax:1};b.appRequests().getActionCall(c,function(c){0!==c.status?b.msg.out(c):q(a,c.data.html)})},"delete":function(a){d.info("appMgmt:delete");var c='<div id="alert"><p id="alert-text">'+b.config().LANG[12]+"</p></div>",g=a.data("selection"),k=[];if(g&&($(g).find(".is-selected").each(function(b,a){var c=$(this);k.push(c.data("item-id"))}),0===k.length))return;showDialog({text:c,
negative:{title:b.config().LANG[44],onClick:function(a){a.preventDefault();b.msg.error(b.config().LANG[44])}},positive:{title:b.config().LANG[43],onClick:function(c){c.preventDefault();c=b.appRequests().getRequestOpts();c.url=e.appMgmt.save;c.data={itemId:g?k:a.data("item-id"),actionId:a.data("action-id"),sk:b.sk.get(),isAjax:1};b.appRequests().getActionCall(c,function(c){b.msg.out(c);a.data("nextaction-id")&&f({actionId:a.data("nextaction-id"),itemId:a.data("activetab")})})}}})},save:function(a){d.info("appMgmt:save");
var c=b.appRequests().getRequestOpts();c.url=e.appMgmt.save;c.data=a.serialize();b.appRequests().getActionCall(c,function(c){b.msg.out(c);0===c.status&&(!0===n.refreshTab&&f({actionId:a.data("nextaction-id"),itemId:a.data("activetab")}),$.magnificPopup.close())})},search:function(a){d.info("appMgmt:search");var c=$(a.data("target")),g=b.appRequests().getRequestOpts();g.url=e.appMgmt.search;g.data=a.serialize();b.appRequests().getActionCall(g,function(a){0===a.status?c.html(a.data.html):c.html(b.msg.html.error(a.description));
b.sk.set(a.csrf)})},nav:function(a){d.info("appMgmt:nav");var c=$("#"+a.data("action-form"));c.find("[name='start']").val(a.data("start"));c.find("[name='count']").val(a.data("count"));c.find("[name='sk']").val(b.sk.get());n.search(c)},ldapSync:function(a){d.info("appMgmt:ldapSync");var c='<div id="alert"><p id="alert-text">'+b.config().LANG[57]+"</p></div>";showDialog({text:c,negative:{title:b.config().LANG[44],onClick:function(a){a.preventDefault();b.msg.error(b.config().LANG[44])}},positive:{title:b.config().LANG[43],
onClick:function(c){c=b.appRequests().getRequestOpts();c.url=e.appMgmt.save;c.data={actionId:a.data("action-id"),sk:b.sk.get(),isAjax:1};b.appRequests().getActionCall(c,function(a){b.msg.out(a)})}}})}};return{doAction:f,appMgmt:n,account:l,file:{view:function(a){d.info("file:view");var c=b.appRequests().getRequestOpts();c.url=e.file;c.type="html";c.data={fileId:a.data("item-id"),sk:b.sk.get(),actionId:a.data("action-id")};b.appRequests().getActionCall(c,function(c){"undefined"!==typeof c.status&&
1===c.status?b.msg.out(c):c?r(a,c):b.msg.error(b.config().LANG[14])})},download:function(a){d.info("file:download");a={fileId:a.data("item-id"),sk:b.sk.get(),actionId:a.data("action-id")};$.fileDownload(b.config().APP_ROOT+e.file,{httpMethod:"POST",data:a})},"delete":function(a){d.info("file:delete");var c='<div id="alert"><p id="alert-text">'+b.config().LANG[15]+"</p></div>";showDialog({text:c,negative:{title:b.config().LANG[44],onClick:function(a){a.preventDefault();b.msg.error(b.config().LANG[44])}},
positive:{title:b.config().LANG[43],onClick:function(c){c=b.appRequests().getRequestOpts();c.url=e.file;c.data={fileId:a.data("item-id"),actionId:a.data("action-id"),sk:b.sk.get()};b.appRequests().getActionCall(c,function(a){b.msg.out(a);0===a.status&&(a=$("#list-account-files"),l.getfiles(a))})}}})}},checks:{ldap:function(a){d.info("checks:ldap");a=$(a.data("src"));a.find("[name='sk']").val(b.sk.get());var c=b.appRequests().getRequestOpts();c.url=e.checks;c.data=a.serialize();b.appRequests().getActionCall(c,
function(a){b.msg.out(a);var c=$("#ldap-results");c.find(".list-wrap").html(b.appTheme().html.getList(a.data));c.show("slow")})},wiki:function(a){d.info("checks:wiki");a=$(a.data("src"));a.find("[name='sk']").val(b.sk.get());var c=b.appRequests().getRequestOpts();c.url=e.checks;c.data=a.serialize();b.appRequests().getActionCall(c,function(a){b.msg.out(a);0===a.status&&$("#dokuWikiResCheck").html(a.data)})}},config:{save:function(a){d.info("config:save");var c=b.appRequests().getRequestOpts();c.url=
e.config.save;c.data=a.serialize();b.appRequests().getActionCall(c,function(c){b.msg.out(c);0===c.status&&"undefined"!==typeof a.data("nextaction-id")&&f({actionId:a.data("nextaction-id"),itemId:a.data("activetab")})})},backup:function(a){d.info("config:backup");var c=b.appRequests().getRequestOpts();c.url=e.config["export"];c.data=a.serialize();b.appRequests().getActionCall(c,function(c){b.msg.out(c);0===c.status&&"undefined"!==typeof a.data("nextaction-id")&&f({actionId:a.data("nextaction-id"),
itemId:a.data("activetab")})})},"export":function(a){d.info("config:export");var c=b.appRequests().getRequestOpts();c.url=e.config["export"];c.data=a.serialize();b.appRequests().getActionCall(c,function(c){b.msg.out(c);0===c.status&&"undefined"!==typeof a.data("nextaction-id")&&f({actionId:a.data("nextaction-id"),itemId:a.data("activetab")})})},"import":function(a){d.info("config:import");var c=b.appRequests().getRequestOpts();c.url=e.config["import"];c.data=a.serialize();b.appRequests().getActionCall(c,
function(c){b.msg.out(c);0===c.status&&"undefined"!==typeof a.data("nextaction-id")&&f({actionId:a.data("nextaction-id"),itemId:a.data("activetab")})})}},main:p,user:{savePreferences:function(a){d.info("user:savePreferences");var c=b.appRequests().getRequestOpts();c.url=e.user.savePreferences;c.data=a.serialize();b.appRequests().getActionCall(c,function(a){b.msg.out(a);setTimeout(function(){window.location.replace("index.php")},2E3)})},saveSecurity:function(a){d.info("user:saveSecurity");var c=b.appRequests().getRequestOpts();
c.url=e.user.savePreferences;c.data=a.serialize();b.appRequests().getActionCall(c,function(c){b.msg.out(c);f({actionId:a.data("nextaction-id"),itemId:a.data("activetab")})})},password:function(a){d.info("user:password");var c=b.appRequests().getRequestOpts();c.type="html";c.method="get";c.url=e.user.password;c.data={actionId:a.data("action-id"),itemId:a.data("item-id"),sk:a.data("sk"),isAjax:1};b.appRequests().getActionCall(c,function(b){0===b.length?p.logout():q(a,b)})},passreset:function(a){d.info("user:passreset");
var c=b.appRequests().getRequestOpts();c.url=e.user.passreset;c.data=a.serialize();b.appRequests().getActionCall(c,function(a){b.msg.out(a)})}},link:{save:function(a){d.info("link:save");var c=b.appRequests().getRequestOpts();c.url=e.link;c.data={itemId:a.data("item-id"),actionId:a.data("action-id"),sk:b.sk.get(),isAjax:1};a='<div id="alert"><p id="alert-text">'+b.config().LANG[48]+"</p></div>";showDialog({text:a,negative:{title:b.config().LANG[44],onClick:function(a){a.preventDefault();b.appRequests().getActionCall(c,
function(a){b.msg.out(a)})}},positive:{title:b.config().LANG[43],onClick:function(a){a.preventDefault();c.data.notify=1;b.appRequests().getActionCall(c,function(a){b.msg.out(a)})}}})},refresh:function(a){d.info("link:refresh");a={itemId:a.data("item-id"),actionId:a.data("action-id"),sk:b.sk.get(),activeTab:a.data("activetab")};var c=b.appRequests().getRequestOpts();c.url=e.link;c.data=a;b.appRequests().getActionCall(c,function(a){b.msg.out(a)})}},eventlog:{nav:function(a){if("undefined"===typeof a.data("start"))return!1;
var c=b.appRequests().getRequestOpts();c.url=e.eventlog;c.type="html";c.data={start:a.data("start"),current:a.data("current")};b.appRequests().getActionCall(c,function(a){$("#content").html(a);b.scrollUp()})},clear:function(a){var c='<div id="alert"><p id="alert-text">'+b.config().LANG[20]+"</p></div>";showDialog({text:c,negative:{title:b.config().LANG[44],onClick:function(a){a.preventDefault();b.msg.error(b.config().LANG[44])}},positive:{title:b.config().LANG[43],onClick:function(c){c.preventDefault();
c=b.appRequests().getRequestOpts();c.url=e.eventlog;c.data={clear:1,sk:b.sk.get(),isAjax:1};b.appRequests().getActionCall(c,function(c){b.msg.out(c);0==c.status&&f({actionId:a.data("nextaction-id")})})}}})}},ajaxUrl:e}};
