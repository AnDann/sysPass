var $jscomp={scope:{},findInternal:function(b,d,h){b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var n=b[f];if(d.call(h,n,f,b))return{i:f,v:n}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,h){if(h.get||h.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[d]=h.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,d,h,e){if(d){h=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var f=b[e];f in h||(h[f]={});h=h[f]}b=b[b.length-1];e=h[b];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(h,b,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,h){return $jscomp.findInternal(this,b,h).v}},"es6-impl","es3");
sysPass.Actions=function(b){var d=b.log,h,e={doAction:"/ajax/ajax_getContent.php",updateItems:"/ajax/ajax_getItems.php",user:{savePreferences:"/ajax/ajax_userPrefsSave.php",password:"/ajax/ajax_usrpass.php",passreset:"/ajax/ajax_passReset.php"},main:{login:"/ajax/ajax_doLogin.php",install:"/ajax/ajax_install.php",twofa:"/ajax/ajax_2fa.php",getUpdates:"/ajax/ajax_checkUpds.php"},checks:"/ajax/ajax_checkConnection.php",config:{save:"/ajax/ajax_configSave.php","export":"/ajax/ajax_export.php","import":"/ajax/ajax_import.php"},
file:"/ajax/ajax_filesMgmt.php",link:"/ajax/ajax_itemSave.php",account:{save:"/ajax/ajax_itemSave.php",showPass:"/ajax/ajax_accViewPass.php",saveFavorite:"/ajax/ajax_appMgmtSave.php",request:"/ajax/ajax_sendRequest.php",getFiles:"/ajax/ajax_accGetFiles.php",search:"/ajax/ajax_accSearch.php"},appMgmt:{show:"/ajax/ajax_itemShow.php",save:"/ajax/ajax_itemSave.php",search:"/ajax/ajax_itemSearch.php"},eventlog:"/ajax/ajax_eventlog.php",wiki:{show:"/ajax/ajax_wiki.php"}},f=function(c){c={actionId:c.actionId,
itemId:"undefined"!==typeof c.itemId?c.itemId:0,isAjax:1};var a=b.appRequests().getRequestOpts();a.url=e.doAction;a.type="html";a.addHistory=!0;a.data=c;b.appRequests().getActionCall(a,function(b){$("#content").empty().html(b)})},n=function(c){d.info("updateItems");var a=$("#"+c.data("item-dst"))[0].selectize;a.clearOptions();a.load(function(a){var g=b.appRequests().getRequestOpts();g.url=e.updateItems;g.method="get";g.data={sk:b.sk.get(),itemType:c.data("item-type")};b.appRequests().getActionCall(g,
function(b){a(b.items)})})},p=function(c,a){$.fancybox(a,{padding:[0,0,0,0],afterClose:function(){c.data("item-dst")&&n(c)},beforeShow:function(){b.appTriggers().views.common("#fancyContainer")}})},q={logout:function(){var c=window.location.search;b.redirect(0<c.length?"index.php"+c+"&logout=1":"index.php?logout=1")},login:function(c){d.info("main:login");var a=b.appRequests().getRequestOpts();a.url=e.main.login;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){switch(a.status){case 0:b.redirect(a.data.url);
break;case 2:b.msg.out(a);c.find("input[type='text'],input[type='password']").val("");c.find("input:first").focus();$("#mpass").prop("disabled",!1);$("#smpass").val("").show();break;default:b.msg.out(a),c.find("input[type='text'],input[type='password']").val(""),c.find("input:first").focus()}})},install:function(c){d.info("main:install");var a=b.appRequests().getRequestOpts();a.url=e.main.install;a.data=c.serialize();b.appRequests().getActionCall(a,function(c){b.msg.out(c);0==c.status&&setTimeout(function(){b.redirect("index.php")},
1E3)})},twofa:function(c){d.info("main:twofa");var a=b.appRequests().getRequestOpts();a.url=e.main.twofa;a.data=c.serialize();b.appRequests().getActionCall(a,function(c){b.msg.out(c);0==c.status&&setTimeout(function(){b.redirect("index.php")},1E3)})},getUpdates:function(c){d.info("main:getUpdates");c=b.appRequests().getRequestOpts();c.url=e.main.getUpdates;c.type="html";c.method="get";c.timeout=1E4;c.useLoading=!1;c.data={isAjax:1};b.appRequests().getActionCall(c,function(b){$("#updates").html(b);
"undefined"!==typeof componentHandler&&componentHandler.upgradeDom()},function(){$("#updates").html("!")})}},l={show:function(b){d.info("account:show");f({actionId:b.data("action-id"),itemId:b.data("item-id")})},showHistory:function(b){d.info("account:showHistory");f({actionId:b.data("action-id"),itemId:b.val()})},edit:function(b){d.info("account:edit");f({actionId:b.data("action-id"),itemId:b.data("item-id")})},"delete":function(c){d.info("account:delete");var a='<div id="alert"><p id="alert-text">'+
b.config().LANG[3]+"</p></div>";alertify.okBtn(b.config().LANG[43]).cancelBtn(b.config().LANG[44]).confirm(a,function(a){a=b.appRequests().getRequestOpts();a.url=e.account.save;a.data={itemId:c.data("item-id"),actionId:c.data("action-id"),sk:b.sk.get()};b.appRequests().getActionCall(a,function(c){b.msg.out(c);l.search()})},function(c){c.preventDefault();alertify.error(b.config().LANG[44])})},showpass:function(c){d.info("account:showpass");var a=b.appRequests().getRequestOpts();a.url=e.account.showPass;
a.data={itemId:c.data("item-id"),isHistory:c.data("history"),isFull:c.data("full"),isAjax:1};b.appRequests().getActionCall(a,function(c){if(10===c.status)q.logout();else{var a;$("<div></div>").dialog({modal:!0,title:b.config().LANG[47],width:"auto",open:function(){a=$(this);var g,d="";g='<button class="dialog-clip-user-button ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" data-clipboard-target=".dialog-user-text"><span class="ui-button-icon-primary ui-icon ui-icon-clipboard"></span><span class="ui-button-text">'+
b.config().LANG[33]+"</span></button>";var e='<button class="dialog-clip-pass-button ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" data-clipboard-target=".dialog-pass-text"><span class="ui-button-icon-primary ui-icon ui-icon-clipboard"></span><span class="ui-button-text">'+b.config().LANG[34]+"</span></button>",d=c.useimage,k='<p class="dialog-user-text">'+c.acclogin+"</p>";0===c.status?(0===d?d='<p class="dialog-pass-text">'+c.accpass+"</p>":(d='<img class="dialog-pass-text" src="data:image/png;base64,'+
c.accpass+'" />',e=""),g=k+d+'<div class="dialog-buttons">'+g+e+"</div>"):(g='<span class="altTxtRed">'+c.description+"</span>",a.dialog("option","buttons",[{text:"Ok",icons:{primary:"ui-icon-close"},click:function(){a.dialog("close")}}]));a.html(g);a.dialog("option","position","center");a.parent().on("mouseleave",function(){clearTimeout(h);h=setTimeout(function(){a.dialog("close")},3E4)})},close:function(){clearTimeout(h);a.dialog("destroy")}})}})},copypass:function(c){d.info("account:copypass");
var a=b.appRequests().getRequestOpts();a.url=e.account.showPass;a.async=!1;a.data={itemId:c.data("item-id"),isHistory:c.data("history"),isAjax:1};return b.appRequests().getActionCall(a)},copy:function(b){d.info("account:copy");f({actionId:b.data("action-id"),itemId:b.data("item-id")})},savefavorite:function(c,a){d.info("account:saveFavorite");var g="on"===c.data("status"),k={actionId:g?c.data("action-id-off"):c.data("action-id-on"),itemId:c.data("item-id"),sk:b.sk.get(),isAjax:1},f=b.appRequests().getRequestOpts();
f.url=e.account.saveFavorite;f.data=k;b.appRequests().getActionCall(f,function(d){b.msg.out(d);0===d.status&&(c.data("status",g?"off":"on"),"function"===typeof a&&a())})},request:function(c){d.info("account:request");var a=b.appRequests().getRequestOpts();a.url=e.account.request;a.data=c.serialize();b.appRequests().getActionCall(a,function(c){b.msg.out(c)})},menu:function(b){b.hide();b.parent().children(".actions-optional").show(250)},sort:function(b){d.info("account:sort");var c=$("#frmSearch");
c.find('input[name="skey"]').val(b.data("key"));c.find('input[name="sorder"]').val(b.data("dir"));c.find('input[name="start"]').val(b.data("start"));l.search()},editpass:function(b){d.info("account:editpass");f({actionId:b.data("action-id"),itemId:b.data("item-id")})},restore:function(b){d.info("account:restore");l.save(b)},getfiles:function(c){d.info("account:getfiles");var a=b.appRequests().getRequestOpts();a.method="get";a.type="html";a.url=e.account.getFiles;a.data={id:c.data("item-id"),del:c.data("delete"),
sk:b.sk.get()};b.appRequests().getActionCall(a,function(b){c.html(b)})},search:function(){d.info("account:search");var c=$("#frmSearch");c.find("input[name='sk']").val(b.sk.get());c.find("input[name='skey']").val();c.find("input[name='sorder']").val();var a=b.appRequests().getRequestOpts();a.url=e.account.search;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){10===a.status&&b.msg.out(a);b.sk.set(a.sk);$("#res-content").empty().html(a.html);c.find("input:first").focus()})},save:function(c){d.info("account:save");
var a=b.appRequests().getRequestOpts();a.url=e.account.save;a.data=c.serialize();b.appRequests().getActionCall(a,function(c){b.msg.out(c)})}},m={refreshTab:!0,show:function(c){d.info("appMgmt:show");c.data("item-dst")&&(m.refreshTab=!1);var a=b.appRequests().getRequestOpts();a.url=e.appMgmt.show;a.data={itemId:c.data("item-id"),actionId:c.data("action-id"),activeTab:c.data("activetab"),sk:b.sk.get(),isAjax:1};b.appRequests().getActionCall(a,function(a){0!==a.status?b.msg.out(a):p(c,a.data.html)})},
"delete":function(c){d.info("appMgmt:delete");var a='<div id="alert"><p id="alert-text">'+b.config().LANG[12]+"</p></div>",g=c.data("selection"),k=[];if(g&&($(g).find(".is-selected").each(function(b,c){var a=$(this);k.push(a.data("item-id"))}),0===k.length))return;alertify.okBtn(b.config().LANG[43]).cancelBtn(b.config().LANG[44]).confirm(a,function(a){a.preventDefault();a=b.appRequests().getRequestOpts();a.url=e.appMgmt.save;a.data={itemId:g?k:c.data("item-id"),actionId:c.data("action-id"),sk:b.sk.get(),
isAjax:1};b.appRequests().getActionCall(a,function(a){b.msg.out(a);c.data("nextaction-id")&&f({actionId:c.data("nextaction-id"),itemId:c.data("activetab")})})},function(c){c.preventDefault();b.msg.error(b.config().LANG[44])})},save:function(c){d.info("appMgmt:save");var a=b.appRequests().getRequestOpts();a.url=e.appMgmt.save;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);0===a.status&&(!0===m.refreshTab&&f({actionId:c.data("nextaction-id"),itemId:c.data("activetab")}),
m.refreshTab=!0,$.fancybox.close())})},search:function(c){d.info("appMgmt:search");var a=$(c.data("target")),g=b.appRequests().getRequestOpts();g.url=e.appMgmt.search;g.data=c.serialize();b.appRequests().getActionCall(g,function(c){0===c.status?a.html(c.data.html):a.html(b.msg.html.error(c.description));b.sk.set(c.csrf)})},nav:function(c){d.info("appMgmt:nav");var a=$("#"+c.data("action-form"));a.find("[name='start']").val(c.data("start"));a.find("[name='count']").val(c.data("count"));a.find("[name='sk']").val(b.sk.get());
m.search(a)},ldapSync:function(c){d.info("appMgmt:ldapSync");var a='<div id="alert"><p id="alert-text">'+b.config().LANG[57]+"</p></div>";alertify.okBtn(b.config().LANG[43]).cancelBtn(b.config().LANG[44]).confirm(a,function(a){a=b.appRequests().getRequestOpts();a.url=e.appMgmt.save;a.data={actionId:c.data("action-id"),sk:b.sk.get(),isAjax:1};b.appRequests().getActionCall(a,function(c){b.msg.out(c)})},function(c){c.preventDefault();alertify.error(b.config().LANG[44])})}};return{doAction:f,appMgmt:m,
account:l,file:{view:function(c){d.info("file:view");var a=b.appRequests().getRequestOpts();a.url=e.file;a.type="html";a.data={fileId:c.data("item-id"),sk:b.sk.get(),actionId:c.data("action-id")};b.appRequests().getActionCall(a,function(a){"undefined"!==typeof a.status&&1===a.status?b.msg.out(a):a?p(c,a):b.msg.error(b.config().LANG[14])})},download:function(c){d.info("file:download");c={fileId:c.data("item-id"),sk:b.sk.get(),actionId:c.data("action-id")};$.fileDownload(b.config().APP_ROOT+e.file,
{httpMethod:"POST",data:c})},"delete":function(c){d.info("file:delete");var a='<div id="alert"><p id="alert-text">'+b.config().LANG[15]+"</p></div>";alertify.okBtn(b.config().LANG[43]).cancelBtn(b.config().LANG[44]).confirm(a,function(a){a=b.appRequests().getRequestOpts();a.url=e.file;a.data={fileId:c.data("item-id"),actionId:c.data("action-id"),sk:b.sk.get()};b.appRequests().getActionCall(a,function(a){b.msg.out(a);0===a.status&&(a=$("#list-account-files"),l.getfiles(a))})},function(a){a.preventDefault();
alertify.error(b.config().LANG[44])})}},checks:{ldap:function(c){d.info("checks:ldap");c=$(c.data("src"));c.find("[name='sk']").val(b.sk.get());var a=b.appRequests().getRequestOpts();a.url=e.checks;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);var c=$("#ldap-results");c.find(".list-wrap").html(b.appTheme().html.getList(a.data));c.show("slow")})},wiki:function(c){d.info("checks:wiki");c=$(c.data("src"));c.find("[name='sk']").val(b.sk.get());var a=b.appRequests().getRequestOpts();
a.url=e.checks;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);0===a.status&&$("#dokuWikiResCheck").html(a.data)})}},config:{save:function(c){d.info("config:save");var a=b.appRequests().getRequestOpts();a.url=e.config.save;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);0===a.status&&"undefined"!==typeof c.data("nextaction-id")&&f({actionId:c.data("nextaction-id"),itemId:c.data("activetab")})})},backup:function(c){d.info("config:backup");
var a=b.appRequests().getRequestOpts();a.url=e.config["export"];a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);0===a.status&&"undefined"!==typeof c.data("nextaction-id")&&f({actionId:c.data("nextaction-id"),itemId:c.data("activetab")})})},"export":function(c){d.info("config:export");var a=b.appRequests().getRequestOpts();a.url=e.config["export"];a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);0===a.status&&"undefined"!==typeof c.data("nextaction-id")&&
f({actionId:c.data("nextaction-id"),itemId:c.data("activetab")})})},"import":function(c){d.info("config:import");var a=b.appRequests().getRequestOpts();a.url=e.config["import"];a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);0===a.status&&"undefined"!==typeof c.data("nextaction-id")&&f({actionId:c.data("nextaction-id"),itemId:c.data("activetab")})})}},main:q,user:{savePreferences:function(c){d.info("user:savePreferences");var a=b.appRequests().getRequestOpts();a.url=
e.user.savePreferences;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);setTimeout(function(){window.location.replace("index.php")},2E3)})},saveSecurity:function(c){d.info("user:saveSecurity");var a=b.appRequests().getRequestOpts();a.url=e.user.savePreferences;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a);f({actionId:c.data("nextaction-id"),itemId:c.data("activetab")})})},password:function(c){d.info("user:password");var a=b.appRequests().getRequestOpts();
a.type="html";a.method="get";a.url=e.user.password;a.data={actionId:c.data("action-id"),itemId:c.data("item-id"),sk:c.data("sk"),isAjax:1};b.appRequests().getActionCall(a,function(a){0===a.length?q.logout():p(c,a)})},passreset:function(c){d.info("user:passreset");var a=b.appRequests().getRequestOpts();a.url=e.user.passreset;a.data=c.serialize();b.appRequests().getActionCall(a,function(a){b.msg.out(a)})}},link:{save:function(c){d.info("link:save");var a=b.appRequests().getRequestOpts();a.url=e.link;
a.data={itemId:c.data("item-id"),actionId:c.data("action-id"),sk:b.sk.get(),isAjax:1};alertify.okBtn(b.config().LANG[40]).cancelBtn(b.config().LANG[41]).confirm(b.config().LANG[48],function(c){c.preventDefault();a.data.notify=1;b.appRequests().getActionCall(a,function(a){b.msg.out(a)})},function(c){c.preventDefault();b.appRequests().getActionCall(a,function(a){b.msg.out(a)})})},refresh:function(c){d.info("link:refresh");c={itemId:c.data("item-id"),actionId:c.data("action-id"),sk:b.sk.get(),activeTab:c.data("activetab")};
var a=b.appRequests().getRequestOpts();a.url=e.link;a.data=c;b.appRequests().getActionCall(a,function(a){b.msg.out(a)})}},eventlog:{nav:function(c){if("undefined"===typeof c.data("start"))return!1;var a=b.appRequests().getRequestOpts();a.url=e.eventlog;a.type="html";a.data={start:c.data("start"),current:c.data("current")};b.appRequests().getActionCall(a,function(a){$("#content").html(a);b.scrollUp()})},clear:function(c){var a='<div id="alert"><p id="alert-text">'+b.config().LANG[20]+"</p></div>";
alertify.okBtn(b.config().LANG[43]).cancelBtn(b.config().LANG[44]).confirm(a,function(a){a.preventDefault();a=b.appRequests().getRequestOpts();a.url=e.eventlog;a.data={clear:1,sk:b.sk.get(),isAjax:1};b.appRequests().getActionCall(a,function(a){b.msg.out(a);0==a.status&&f({actionId:c.data("nextaction-id")})})},function(a){a.preventDefault();b.msg.error(b.config().LANG[44])})}},ajaxUrl:e}};
