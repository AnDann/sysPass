var $jscomp={scope:{},checkStringArgs:function(b,c,a){if(null==b)throw new TypeError("The 'this' value for String.prototype."+a+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+a+" must not be a regular expression");return b+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){if(a.get||a.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[c]=a.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,c,a,d){if(c){a=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in a||(a[e]={});a=a[e]}b=b[b.length-1];d=a[b];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(b,a){var c=$jscomp.checkStringArgs(this,b,"startsWith");b+="";for(var e=c.length,f=b.length,h=Math.max(0,Math.min(a|0,c.length)),g=0;g<f&&h<e;)if(c[h++]!=b[g++])return!1;return g>=f}},"es6-impl","es3");
sysPass.Requests=function(b){var c=b.log,a=[],d={type:"json",url:"",method:"post",callback:"",async:!0,data:"",cache:!1,processData:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",timeout:0,addHistory:!1,hash:"",useLoading:!0,useFullLoading:!1};Object.seal(d);var e={get:function(){return a},add:function(b){var f=""===b.hash?SparkMD5.hash(JSON.stringify(b),!1):b.hash;if(0<a.length&&a[a.length-1].hash===f)return a;c.info("history:add");b.hash=f;a.push(b);15<=a.length&&a.splice(0,10);
return a},del:function(){c.info("history:del");if("undefined"!==typeof a.pop())return a[a.length-1]},reset:function(){c.info("history:reset");a=[]},length:function(){return a.length}};return{getRequestOpts:function(){return Object.create(d)},getActionCall:function(a,d,g){c.info("getActionCall");var f=a.url.startsWith("http",0)||a.url.startsWith("https",0)?a.url:b.config().APP_ROOT+a.url;return $.ajax({dataType:a.type,url:f,method:a.method,async:a.async,data:a.data,cache:a.cache,processData:a.processData,
contentType:a.contentType,timeout:a.timeout,beforeSend:function(){!0===a.useLoading&&b.appTheme().loading.show(a.useFullLoading)},success:function(b){if("function"!==typeof d)return!0;!0===a.addHistory&&(a.callback=d,e.add(a));d(b)},error:function(d,f,e){"function"!==typeof g?(d=b.config().LANG[1]+"<p>"+e+f+"</p>",c.error(d),"html"===a.type&&$("#content").html(b.msg.html.error(e)),b.msg.error(d)):g()},complete:function(){!0===a.useLoading&&b.appTheme().loading.hide();b.appTheme().ajax.complete()}})},
getActionEvent:function(a,d,e){var f=a.url.startsWith("http",0)||a.url.startsWith("https",0)?a.url:b.config().APP_ROOT+a.url,f=f+("?"+$.param(a.data)),g=new EventSource(f);g.addEventListener("message",function(a){a=JSON.parse(a.data);c.debug(a);1===a.end?(c.info("getActionEvent:Ending"),g.close(),"function"===typeof e&&e(a)):"function"===typeof d&&d(a)});g.addEventListener("error",function(a){c.error("getActionEvent:Error occured");g.close()});return g},history:e}};
