var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,h,k){if(k.get||k.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[h]=k.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var h=0;return $jscomp.iteratorPrototype(function(){return h<a.length?{done:!1,value:a[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,h){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var k=0,e={next:function(){if(k<a.length){var l=k++;return{value:h(l,a[l]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(a,h,k,e){if(h){k=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var l=a[e];l in k||(k[l]={});k=k[l]}a=a[a.length-1];e=k[a];h=h(e);h!=e&&null!=h&&$jscomp.defineProperty(k,a,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.findInternal=function(a,h,k){a instanceof String&&(a=String(a));for(var e=a.length,l=0;l<e;l++){var f=a[l];if(h.call(k,f,l,a))return{i:l,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,k){return $jscomp.findInternal(this,a,k).v}},"es6-impl","es3");
sysPass.Main=function(){var a={APP_ROOT:"",LANG:[],PK:"",MAX_FILE_SIZE:1024,crypt:new JSEncrypt,CHECK_UPDATES:!1},h={passLength:0,minPasswordLength:8,complexity:{numbers:!0,symbols:!0,uppercase:!0,numlength:12}},k={},e={},l={},f={},t={},q={},m={log:function(b){console.log(b)},info:function(b){console.info(b)},error:function(b){console.error(b)},warn:function(b){console.warn(b)}},p=function(b){var a=b.status,c=b.description,g=b.action;"undefined"!==typeof b.messages&&0<b.messages.length&&(c=c+"<br>"+
b.messages.join("<br>"));switch(a){case 0:$.fancybox.close();n("ok",c,void 0,g);break;case 1:$.fancybox.close();$(":input[type='password']").val("");n("error",c,void 0,g);break;case 2:n("error",c,void 0,g);break;case 3:$.fancybox.close();n("warn",c,void 0,g);break;case 10:l.main.logout()}},z=function(b){m.info("getEnvironment");var d=window.location.pathname.split("/"),c=window.location.protocol+"//"+window.location.host+function(){for(var b="",a=1;a<=d.length-2;a++)b+="/"+d[a];return b}(),g=f.getRequestOpts();
g.url=c+"/ajax/ajax_getEnvironment.php";g.method="get";g.async=!1;g.data={isAjax:1};f.getActionCall(g,function(c){a.APP_ROOT=c.app_root;a.LANG=c.lang;a.PK=c.pk;a.CHECK_UPDATES=c.check_updates;a.crypt.setPublicKey(c.pk);"function"===typeof b&&b()})},v={get:function(){m.info("sk:get");return $("#content").attr("data-sk")},set:function(b){m.info("sk:set");$("#content").attr("data-sk",b)}},A=function(){var b=$("#container");if(!b.hasClass("content-no-auto-resize")){var a=$("#content").height()+200;b.css("height",
a)}},w=function(){$("html, body").animate({scrollTop:0},"slow")},B=function(a,d){if("undefined"===typeof a)return!1;var b=f.getRequestOpts();b.url="/ajax/ajax_eventlog.php";b.type="html";b.data={start:a,current:d};f.getActionCall(b,function(a){$("#content").html(a);w()})},C=function(a){location.href=a},D=function(){var a=f.getRequestOpts();a.url="/ajax/ajax_sendRequest.php";a.data=$("#frmRequestModify").serialize();f.getActionCall(a,function(a){p(a)})},E=function(b){var d=function(){return{actionId:b.data("action-id"),
itemId:b.data("item-id"),sk:v.get()}},c={requestDoneAction:"",requestData:function(a){d=function(){return a}},beforeSendAction:"",url:""},g=function(a){if("undefined"===typeof c.url||""===c.url)return!1;var b=new FormData;b.append("inFile",a);b.append("isAjax",1);var g=d();Object.keys(g).forEach(function(a){m.info(a);b.append(a,g[a])});a=f.getRequestOpts();a.url=c.url;a.processData=!1;a.contentType=!1;a.data=b;f.getActionCall(a,function(a){var b=a.status;a=a.description;0===b?("function"===typeof c.requestDoneAction&&
c.requestDoneAction(),n("ok",a)):10===b?l.main.logout():n("error",a)})},r=function(c){if(5<c.length)n("error",a.LANG[17]+" (Max: 5)");else for(var d=0;d<c.length;d++){var f=c[d];if(f.size/1E3>a.MAX_FILE_SIZE)n("error",a.LANG[18]+"<br>"+f.name+" (Max: "+a.MAX_FILE_SIZE+")");else{var e;a:{e=f.name;for(var r=b.data("files-ext").toLowerCase().split(","),h=0;h<=r.length;h++)if(-1!==e.indexOf(r[h])){e=!0;break a}e=!1}e?g(c[d]):n("error",a.LANG[19]+"<br>"+f.name)}}},e=function(a){var b=$("#fileUploadForm");
!1===a&&b.hide();a=b.find("input[type='file']");a.on("change",function(){"function"===typeof c.beforeSendAction&&c.beforeSendAction();r(this.files)});return a};window.File&&window.FileList&&window.FileReader?function(){m.info("fileUpload:init");var a=e(!1);b.on("dragover dragenter",function(a){m.info("fileUpload:drag");a.stopPropagation();a.preventDefault()});b.on("drop",function(a){m.info("fileUpload:drop");a.stopPropagation();a.preventDefault();"function"===typeof c.beforeSendAction&&c.beforeSendAction();
r(a.dataTransfer.files)});b.on("click",function(){a.click()})}():e(!0);return c},F=function(a,d){var b=f.getRequestOpts();b.url=d;b.data=a;f.getActionCall(b,function(a){p(a)})},G=function(b,d,c){var g={itemId:b,actionId:d,sk:c,isAjax:1};alertify.okBtn(a.LANG[40]).cancelBtn(a.LANG[41]).confirm(a.LANG[48],function(a){$.extend(g,{notify:1});a=f.getRequestOpts();a.url="/ajax/ajax_appMgmtSave.php";a.data=g;f.getActionCall(a,function(a){p(a)})},function(a){a.preventDefault();a=f.getRequestOpts();a.url=
"/ajax/ajax_appMgmtSave.php";a.data=g;f.getActionCall(a,function(a){p(a)})})},H=function(a,d,c){var b=$(a).attr("data-itemid"),e=$(a).attr("data-activetab");a=$(a).attr("data-nextactionid");d={itemId:b,actionId:d,sk:c,activeTab:e,onCloseAction:a};c=f.getRequestOpts();c.url="/ajax/ajax_appMgmtSave.php";c.data=d;f.getActionCall(c,function(a){p(a)})},x=function(){var a=f.getRequestOpts();a.type="html";a.method="get";a.timeout=1E4;a.url="/ajax/ajax_checkUpds.php";f.getActionCall(a,function(a){$("#updates").html(a);
"undefined"!==typeof componentHandler&&componentHandler.upgradeDom()},function(){$("#updates").html("!")})},I=function(b){var d='<div id="alert"><p id="alert-text">'+a.LANG[20]+"</p></div>";alertify.okBtn(a.LANG[43]).cancelBtn(a.LANG[44]).confirm(d,function(a){a=f.getRequestOpts();a.url="/ajax/ajax_eventlog.php";a.data={clear:1,sk:b,isAjax:1};f.getActionCall(a,function(a){p(a)})},function(b){b.preventDefault();alertify.error(a.LANG[44])})},J=function(a,d){h.passLength=a.length;y(zxcvbn(a),d)},y=function(b,
d){var c,g=b.score;c=$(".passLevel-"+d);c.show();c.removeClass("weak good strong strongest");0===h.passLength?c.attr("title","").empty():h.passLength<h.minPasswordLength?c.attr("title",a.LANG[11]).addClass("weak"):0===g?c.attr("title",a.LANG[9]+" - "+b.feedback.warning).addClass("weak"):1===g||2===g?c.attr("title",a.LANG[8]+" - "+b.feedback.warning).addClass("good"):3===g?c.attr("title",a.LANG[7]).addClass("strong"):4===g&&c.attr("title",a.LANG[10]).addClass("strongest")},n=function(b,d,c,g){if("undefined"!==
typeof c){var e=f.getRequestOpts();e.type="get";e.method="html";e.url=c;e.async=!1;f.getActionCall(e,function(a){d=a})}d=d.replace(/(\\n|;;)/g,"<br>");switch(b){case "ok":alertify.closeLogOnClick(!0).delay(15E3).success(d);break;case "error":alertify.closeLogOnClick(!0).delay(15E3).error(d);break;case "warn":alertify.delay(3E4).log(d);break;case "nofancyerror":return b='<p class="error round">Oops...<br>'+a.LANG[1]+"<br>"+d+"</p>";default:alertify.error(d)}"undefined"!==typeof g&&eval(g)},K=function(b){$(b).find(".checkbox").button({icons:{primary:"ui-icon-transferthick-e-w"}}).click(function(){var b=
$(this);!0===b.prop("checked")?b.button("option","label",a.LANG[40]):b.button("option","label",a.LANG[41])})},u=function(b){var d=$(b),c=d.val();b+="-encrypted";var e=d.next(':input[name="'+b+'"]');if(""!==c&&e.attr("name")!==b||""!==c&&e.attr("name")===b&&parseInt(d.next().val())!==c.length)c=a.crypt.encrypt(c),d.val(c),0<e.length?e.val(c.length):d.after('<input type="hidden" name="'+b+'" value="'+c.length+'" />')},L=function(){m.info("initializeClipboard");var b=new Clipboard(".clip-pass-button",
{text:function(a){return l.account.copypass($(a)).responseJSON.accpass}});b.on("success",function(b){n("ok",a.LANG[45])});b.on("error",function(b){n("error",a.LANG[46])});var b=new Clipboard(".dialog-clip-pass-button"),d=new Clipboard(".dialog-clip-user-button");b.on("success",function(a){$(".dialog-pass-text").addClass("dialog-clip-pass-copy round");a.clearSelection()});d.on("success",function(a){a.clearSelection()})},M=function(){m.info("bindPassEncrypt");var a=$("body");a.on("blur",":input[type=password]",
function(a){$(this).hasClass("passwordfield__no-pki")||(a=$(this).attr("id"),u("#"+a))});a.on("keypress",":input[type=password]",function(a){if(13===a.keyCode){a.preventDefault();a=$(this).closest("form");var b=$(this).attr("id");u("#"+b);a.submit()}})},N=function(a,d,c){var b=f.getRequestOpts();b.type="html";b.url="/ajax/ajax_wiki.php";b.data={pageName:a,actionId:d,sk:c,isAjax:1};f.getActionCall(b,function(a){$.fancybox(a,{padding:[0,10,10,10]})})},O=function(a,d){console.info("Eval: "+a);if("function"===
typeof a)a(d);else throw Error("Function not found: "+a);},P=function(){return $.extend({log:m,config:function(){return a},appTheme:function(){return k},appActions:function(){return l},appTriggers:function(){return e},appRequests:function(){return f},evalAction:O},t)},Q=function(){return{sk:v,actions:function(){return l},triggers:function(){return e},jsonResponseMessage:p,checkboxDetect:K,checkPassLevel:J,checkUpds:x,clearEventlog:I,encryptFormValue:u,fileUpload:E,linksMgmtSave:G,linksMgmtRefresh:H,
navLog:B,outputResult:y,passToClip:0,passwordData:h,redirect:C,resMsg:n,scrollUp:w,sendAjax:F,sendRequest:D,setContentSize:A,viewWiki:N}};(function(){m.info("init");t=Q();q=P();e=sysPass.Triggers(q);l=sysPass.Actions(q);f=sysPass.Requests(q);z(function(){""!==a.PK&&M();"function"===typeof sysPass.Theme&&(k=sysPass.Theme(q));!0===a.CHECK_UPDATES&&x();L();m.info("setupCallbacks");0<$("#boxLogin").length&&e.views.login();0<$("#searchbox").length&&e.views.search();0<$("footer").length&&e.views.footer()})})();
return t};
