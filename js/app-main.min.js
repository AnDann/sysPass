var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[f]=g.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var f=0;return $jscomp.iteratorPrototype(function(){return f<a.length?{done:!1,value:a[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,f){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var g=0,c={next:function(){if(g<a.length){var l=g++;return{value:f(l,a[l]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill=function(a,f,g,c){if(f){g=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var l=a[c];l in g||(g[l]={});g=g[l]}a=a[a.length-1];c=g[a];f=f(c);f!=c&&null!=f&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.findInternal=function(a,f,g){a instanceof String&&(a=String(a));for(var c=a.length,l=0;l<c;l++){var m=a[l];if(f.call(g,m,l,a))return{i:l,v:m}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,g){return $jscomp.findInternal(this,a,g).v}},"es6-impl","es3");
sysPass.Main=function(){var a={APP_ROOT:"",LANG:[],PK:"",MAX_FILE_SIZE:1024,CRYPT:new JSEncrypt,CHECK_UPDATES:!1,TIMEZONE:"",LOCALE:"",DEBUG:"",COOKIES_ENABLED:!1},f={passLength:0,minPasswordLength:8,complexity:{chars:!0,numbers:!0,symbols:!0,uppercase:!0,numlength:12}};Object.seal(f);var g={},c={},l={},m={},p={},n={},h={log:function(b){!0===a.DEBUG&&console.log(b)},info:function(b){!0===a.DEBUG&&console.info(b)},error:function(b){console.error(b)},warn:function(b){console.warn(b)},debug:function(b){!0===
a.DEBUG&&console.debug(b)}};Object.freeze(h);toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var w=function(){h.info("setupCallbacks");var b=$("#container").data("page");if(""!==b&&"function"===typeof c.views[b])c.views[b]();0<$("footer").length&&c.views.footer();
$("#btnBack").click(function(){t("index.php")});c.bodyHooks()},k={ok:function(b){toastr.success(b)},error:function(b){toastr.error(b)},warn:function(b){toastr.warning(b)},info:function(b){toastr.info(b)},sticky:function(b,e){var d={timeOut:0};"function"===typeof e&&(d.onHidden=e);toastr.warning(b,a.LANG[60],d)},out:function(b){if("object"===typeof b){var a=b.status,d=b.description;void 0!==b.messages&&0<b.messages.length&&(d=d+"<br>"+b.messages.join("<br>"));switch(a){case 0:k.ok(d);break;case 1:case 2:case 4:k.error(d);
break;case 3:k.warn(d);break;case 10:l.main.logout();break;case 100:k.ok(d);k.sticky(d);break;case 101:k.error(d);k.sticky(d);break;default:k.error(d)}}},html:{error:function(b){return'<p class="error round">Oops...<br>'+a.LANG[1]+"<br>"+b+"</p>"}}};Object.freeze(k);var x=function(){h.info("getEnvironment");var b=window.location.pathname.split("/");a.APP_ROOT=window.location.protocol+"//"+window.location.host+function(){for(var a="",e=1;e<=b.length-2;e++)a+="/"+b[e];return a}();var e=m.getRequestOpts();
e.url="/ajax/ajax_getEnvironment.php";e.method="get";e.useLoading=!1;e.data={isAjax:1};return m.getActionCall(e,function(b){a.LANG=b.lang;a.PK=b.pk;a.CHECK_UPDATES=b.check_updates;a.CRYPT.setPublicKey(b.pk);a.TIMEZONE=b.timezone;a.LOCALE=b.locale;a.DEBUG=b.debug;a.MAX_FILE_SIZE=parseInt(b.max_file_size);a.COOKIES_ENABLED=b.cookies_enabled;Object.freeze(a)})},q={get:function(){h.info("sk:get");return $("#container").attr("data-sk")},set:function(b){h.info("sk:set");$("#container").attr("data-sk",b)}},
y=function(){var b=$("#container");if(!b.hasClass("content-no-auto-resize")){var a=$("#content").height()+200;b.css("height",a)}},z=function(){$("html, body").animate({scrollTop:0},"slow")},A=function(b){for(var a=[],d,c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),f=0;f<c.length;f++)d=c[f].split("="),a.push(d[0]),a[d[0]]=d[1];return void 0!==b&&void 0!==a[b]?a[b]:a},B=function(){h.info("checkLogout");1===parseInt(A("logout"))&&k.sticky(a.LANG[61],function(){t("index.php")})},
t=function(a){window.location.replace(a)},C=function(b){var e={actionId:b.data("action-id"),itemId:b.data("item-id"),sk:q.get()},d={requestDoneAction:"",setRequestData:function(a){$.extend(e,a)},getRequestData:function(){return e},beforeSendAction:"",url:""},f=function(a){if(void 0===d.url||""===d.url)return!1;var b=new FormData;b.append("inFile",a);b.append("isAjax",1);e.sk=q.get();Object.keys(e).forEach(function(a){b.append(a,e[a])});a=m.getRequestOpts();a.url=d.url;a.processData=!1;a.contentType=
!1;a.data=b;m.getActionCall(a,function(a){var b=a.status;a=a.description;0===b?("function"===typeof d.requestDoneAction&&d.requestDoneAction(),k.ok(a)):10===b?l.main.logout():k.error(a)})},c=function(e){if(5<e.length)k.error(a.LANG[17]+" (Max: 5)");else for(var d=0;d<e.length;d++){var r=e[d];if(r.size/1E3>a.MAX_FILE_SIZE)k.error(a.LANG[18]+"<br>"+r.name+" (Max: "+a.MAX_FILE_SIZE+")");else{var c;a:{c=r.name;for(var g=b.data("files-ext").toLowerCase().split(","),h=0;h<=g.length;h++)if(-1!==c.indexOf(g[h])){c=
!0;break a}c=!1}c?f(e[d]):k.error(a.LANG[19]+"<br>"+r.name)}}},g=function(a){var b=$("#fileUploadForm");!1===a&&b.hide();a=b.find("input[type='file']");a.on("change",function(){"function"===typeof d.beforeSendAction&&d.beforeSendAction();c(this.files)});return a};window.File&&window.FileList&&window.FileReader?function(){h.info("fileUpload:init");var a=g(!1);b.on("dragover dragenter",function(a){h.info("fileUpload:drag");a.stopPropagation();a.preventDefault()});b.on("drop",function(a){h.info("fileUpload:drop");
a.stopPropagation();a.preventDefault();"function"===typeof d.beforeSendAction&&d.beforeSendAction();c(a.originalEvent.dataTransfer.files)});b.on("click",function(){a.click()})}():g(!0);return d},D=function(a){h.info("checkPassLevel");f.passLength=a.val().length;v(zxcvbn(a.val()),a)},v=function(b,e){h.info("outputResult");var d=$(".passLevel-"+e.attr("id")),c=b.score;d.show();d.removeClass("weak good strong strongest");0===f.passLength?d.attr("title","").empty():f.passLength<f.minPasswordLength?d.attr("title",
a.LANG[11]).addClass("weak"):0===c?d.attr("title",a.LANG[9]+" - "+b.feedback.warning).addClass("weak"):1===c||2===c?d.attr("title",a.LANG[8]+" - "+b.feedback.warning).addClass("good"):3===c?d.attr("title",a.LANG[7]).addClass("strong"):4===c&&d.attr("title",a.LANG[10]).addClass("strongest")},u=function(b){h.info("encryptFormValue");var e=b.val();""!==e&&parseInt(b.attr("data-length"))!==e.length&&(e=a.CRYPT.encrypt(e),b.val(e),b.attr("data-length",e.length))},F=function(){h.info("initializeClipboard");
if(clipboard.isSupported())$("body").on("click",".clip-pass-button",function(){var b=l.account.copypass($(this)).done(function(a){q.set(a.csrf)});clipboard.copy(b.responseJSON.data.accpass).then(function(){k.ok(a.LANG[45])},function(b){k.error(a.LANG[46])})}).on("click",".dialog-clip-button",function(){var b=$(this.dataset.clipboardTarget);clipboard.copy(b.text()).then(function(){$(".dialog-text").removeClass("dialog-clip-copy");b.addClass("dialog-clip-copy")},function(b){k.error(a.LANG[46])})}).on("click",
".clip-pass-icon",function(){var b=$(this.dataset.clipboardTarget);clipboard.copy(E(b.val())).then(function(){k.ok(a.LANG[45])},function(b){k.error(a.LANG[46])})});else h.warn(a.LANG[65])},G=function(){h.info("bindPassEncrypt");$("body").on("blur",":input[type=password]",function(a){a=$(this);a.hasClass("passwordfield__no-pki")||u(a)}).on("keypress",":input[type=password]",function(a){13===a.keyCode&&(a.preventDefault(),a=$(this),u(a),a.closest("form").submit())})},H=function(a,e){h.info("Eval: "+
a);if("function"===typeof a)a(e);else throw Error("Function not found: "+a);},I=function(a){h.info("resizeImage");var b=.9*$(window).width(),d=.9*$(window).height(),c={width:a.width(),height:a.height()},f={calc:0,main:0,secondary:0,factor:.9,rel:c.width/c.height},g=function(a){a.main>a.secondary?a.calc=a.main/a.rel:a.main<a.secondary&&(a.calc=a.main*a.rel);a.calc>a.secondary&&(a.main*=a.factor,g(a));return a},k=function(){f.main=b;f.secondary=d;var e=g(f);a.css({width:e.main,height:e.calc});c.width=
e.main;c.height=e.calc},l=function(){f.main=d;f.secondary=b;var e=g(f);a.css({width:e.calc,height:e.main});c.width=e.calc;c.height=e.main};c.width>b?k():c.height>d&&(h.info("height"),l());return c},E=function(){var a=document.createElement("div");return function(b){b&&"string"===typeof b&&(b=b.replace(/<script[^>]*>([\S\s]*?)<\/script>/gmi,""),b=b.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gmi,""),a.innerHTML=b,b=a.textContent,a.textContent="");return b}}();return function(){h.info("init");p={actions:function(){return l},
triggers:function(){return c},theme:function(){return g},sk:q,msg:k,log:h,passwordData:f,outputResult:v,checkPassLevel:D,encryptFormValue:u,fileUpload:C,redirect:t,scrollUp:z,setContentSize:y};n=$.extend({log:h,config:function(){return a},appTheme:function(){return g},appActions:function(){return l},appTriggers:function(){return c},appRequests:function(){return m},evalAction:H,resizeImage:I},p);Object.freeze(p);Object.freeze(n);c=sysPass.Triggers(n);l=sysPass.Actions(n);m=sysPass.Requests(n);"function"===
typeof sysPass.Theme&&(g=sysPass.Theme(n));x().then(function(){""!==a.PK&&G();!0===a.CHECK_UPDATES&&l.main.getUpdates();!1===a.COOKIES_ENABLED&&k.sticky(a.LANG[64]);F();w();B()});return p}()};
